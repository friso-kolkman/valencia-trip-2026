<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#ff6b35">
<title>Valencia Weekendje - Feb 2026</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;500;600&display=swap');

  :root {
    --primary: #ff6b35;
    --secondary: #f7931e;
    --accent: #ffcc02;
    --purple: #667eea;
    --text: #333;
    --text-light: #666;
    --text-muted: #888;
    --bg-light: #f8f9fa;
    --border: #e9ecef;
    --white: #fff;
    --shadow: 0 4px 20px rgba(0,0,0,0.1);
    --shadow-lg: 0 10px 40px rgba(0,0,0,0.15);
    --radius: 16px;
    --radius-sm: 12px;
    --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --safe-bottom: env(safe-area-inset-bottom, 0px);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  html { scroll-behavior: smooth; }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 50%, var(--accent) 100%);
    background-attachment: fixed;
    min-height: 100vh;
    padding: 20px;
    padding-bottom: calc(80px + var(--safe-bottom));
    -webkit-font-smoothing: antialiased;
  }

  .container { max-width: 1200px; margin: 0 auto; }

  /* Header */
  .header { text-align: center; color: var(--white); margin-bottom: 24px; padding-top: 10px; }
  .header h1 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(2rem, 8vw, 3rem);
    text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    margin-bottom: 8px;
    line-height: 1.1;
  }
  .header .subtitle { font-size: clamp(0.9rem, 3vw, 1.1rem); opacity: 0.95; font-weight: 300; }

  /* Grid Layout */
  .main-grid { display: grid; grid-template-columns: 1fr 340px; gap: 16px; }

  /* Cards */
  .card {
    background: var(--white);
    border-radius: var(--radius);
    padding: 20px;
    box-shadow: var(--shadow-lg);
    transition: transform var(--transition), box-shadow var(--transition);
  }

  .card:hover { transform: translateY(-2px); box-shadow: 0 12px 48px rgba(0,0,0,0.18); }

  /* Weather Card */
  .weather-card {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 16px;
    margin-bottom: 20px;
    background: linear-gradient(135deg, var(--purple) 0%, #764ba2 100%);
    color: var(--white);
    padding: 20px 24px;
  }
  .weather-main { text-align: center; }
  .weather-temp { font-size: clamp(2.5rem, 10vw, 3.5rem); font-weight: 600; line-height: 1; }
  .weather-desc { font-size: 0.95rem; opacity: 0.9; text-transform: capitalize; margin-top: 4px; }
  .weather-city { font-size: 1.1rem; font-weight: 500; margin-bottom: 4px; }
  .weather-icon { font-size: clamp(2.5rem, 10vw, 3.5rem); }
  .weather-details { display: flex; gap: 20px; }
  .weather-detail { text-align: center; }
  .weather-detail-value { font-size: 1.2rem; font-weight: 600; }
  .weather-detail-label { font-size: 0.7rem; opacity: 0.8; text-transform: uppercase; letter-spacing: 0.5px; }

  /* Section Headers */
  .section-title {
    font-family: 'Playfair Display', serif;
    color: var(--text);
    margin-bottom: 16px;
    font-size: 1.4rem;
  }

  /* Collapsible Sections */
  .collapsible { margin-bottom: 12px; }

  .collapsible-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px;
    background: #f8f9fa;
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: background var(--transition);
    -webkit-user-select: none;
    user-select: none;
    min-height: 56px; /* Touch target */
  }

  .collapsible-header:hover { background: #f0f1f3; }
  .collapsible-header:active { background: #e8e9eb; }

  .collapsible-header-content {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .collapsible-icon {
    font-size: 1.5rem;
  }

  .collapsible-title {
    font-weight: 600;
    font-size: 1rem;
    color: var(--text);
  }

  .collapsible-subtitle {
    font-size: 0.8rem;
    color: var(--text-muted);
  }

  .collapsible-arrow {
    font-size: 0.8rem;
    color: var(--text-muted);
    transition: transform var(--transition);
  }

  .collapsible.open .collapsible-arrow {
    transform: rotate(180deg);
  }

  .collapsible-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .collapsible.open .collapsible-content {
    max-height: 2000px;
  }

  .collapsible-inner {
    padding: 16px;
    padding-top: 12px;
  }

  /* Day Cards - now inside collapsible */
  .day-card {
    background: #ffffff;
    border-radius: var(--radius-sm);
    margin-bottom: 10px;
    border-left: 4px solid;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
  }
  .day-card.friday { border-color: var(--primary); background: linear-gradient(135deg, #fff5f2 0%, #ffffff 100%); }
  .day-card.saturday { border-color: var(--secondary); background: linear-gradient(135deg, #fff8f0 0%, #ffffff 100%); }
  .day-card.sunday { border-color: var(--accent); background: linear-gradient(135deg, #fffdf0 0%, #ffffff 100%); }
  .day-card.monday { border-color: var(--purple); background: linear-gradient(135deg, #f5f3ff 0%, #ffffff 100%); }

  .day-header {
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    padding: 14px 16px;
    min-height: 54px;
  }
  .day-emoji { font-size: 1.3rem; }
  .day-title { font-weight: 600; font-size: 1rem; color: #333; }
  .day-subtitle { font-size: 0.75rem; color: #666; font-weight: 400; margin-top: 2px; }
  .day-arrow {
    margin-left: auto;
    font-size: 0.7rem;
    color: #999;
    transition: transform var(--transition);
  }
  .day-card.open .day-arrow { transform: rotate(180deg); }

  .day-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .day-card.open .day-content { max-height: 500px; }

  .activity-list { list-style: none; padding: 0 16px 16px; }
  .activity-list li {
    padding: 10px 0;
    border-bottom: 1px solid var(--border);
    font-size: 0.9rem;
    color: #444;
    display: flex;
    align-items: flex-start;
    gap: 12px;
  }
  .activity-list li:last-child { border-bottom: none; }
  .activity-time {
    font-weight: 600;
    color: var(--text-muted);
    min-width: 50px;
    font-size: 0.8rem;
    padding-top: 2px;
  }

  /* Sidebar */
  .sidebar { display: flex; flex-direction: column; gap: 16px; }

  /* Itinerary Section */
  .itinerary-section {
    background: transparent;
    padding: 0;
  }

  .itinerary-section .section-title {
    color: #fff !important;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
    margin-bottom: 12px;
  }

  #map { height: 280px; border-radius: var(--radius-sm); z-index: 1; }

  .card h3 {
    font-family: 'Playfair Display', serif;
    margin-bottom: 12px;
    color: var(--text);
    font-size: 1.15rem;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  /* Clothing */
  .clothing-day {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 12px 0;
    border-bottom: 1px solid var(--border);
  }
  .clothing-day:last-child { border-bottom: none; }
  .clothing-day-info { flex: 1; }
  .clothing-day-name { font-weight: 600; font-size: 0.9rem; color: var(--text); }
  .clothing-day-weather { font-size: 0.75rem; color: var(--text-muted); margin: 3px 0; }
  .clothing-day-items { font-size: 0.8rem; color: var(--text-light); line-height: 1.4; }
  .clothing-icon { font-size: 1.6rem; min-width: 32px; text-align: center; }

  /* Tips */
  .tip {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 10px 0;
    border-bottom: 1px solid var(--border);
  }
  .tip:last-child { border-bottom: none; }
  .tip-icon { font-size: 1.1rem; }
  .tip-text { font-size: 0.85rem; color: var(--text-light); line-height: 1.4; }

  /* Legend */
  .legend { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 12px; }
  .legend-item { display: flex; align-items: center; gap: 6px; font-size: 0.75rem; color: var(--text-muted); }
  .legend-dot { width: 10px; height: 10px; border-radius: 50%; }
  .legend-dot.food { background: #e74c3c; }
  .legend-dot.culture { background: #3498db; }
  .legend-dot.nightlife { background: #9b59b6; }
  .legend-dot.nature { background: #27ae60; }
  .legend-dot.hotel { background: #f39c12; }

  /* Bottom Navigation */
  .bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: var(--white);
    display: flex;
    justify-content: space-around;
    padding: 8px 0;
    padding-bottom: calc(8px + var(--safe-bottom));
    box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
    z-index: 1000;
    display: none;
  }

  .nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 8px 16px;
    border-radius: 12px;
    cursor: pointer;
    transition: all var(--transition);
    text-decoration: none;
    color: var(--text-muted);
    min-width: 64px;
  }

  .nav-item:hover, .nav-item.active {
    color: var(--primary);
    background: rgba(255,107,53,0.1);
  }

  .nav-item-icon { font-size: 1.4rem; }
  .nav-item-label { font-size: 0.65rem; font-weight: 500; }

  .footer {
    text-align: center;
    color: var(--white);
    margin-top: 24px;
    opacity: 0.9;
    font-size: 0.85rem;
    padding-bottom: 20px;
  }

  /* Extra Info Grid */
  .info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 25px;
  }

  .info-card {
    background: white;
    border-radius: 16px;
    padding: 20px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.12);
  }

  .info-card h3 {
    font-family: 'Playfair Display', serif;
    color: #333;
    margin-bottom: 15px;
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  /* Budget Section */
  .budget-item {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px solid #eee;
    font-size: 0.85rem;
  }

  .budget-item:last-child { border-bottom: none; }

  .budget-label { color: #555; }

  .budget-amount { font-weight: 600; color: #333; }

  .budget-total {
    margin-top: 12px;
    padding-top: 12px;
    border-top: 2px solid #f7931e;
    font-weight: 600;
    font-size: 1rem;
  }

  /* Packing List */
  .pack-category {
    margin-bottom: 15px;
  }

  .pack-category-title {
    font-weight: 600;
    font-size: 0.8rem;
    color: #888;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 8px;
  }

  .pack-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 6px 0;
    font-size: 0.85rem;
    color: #444;
    cursor: pointer;
  }

  .pack-item input[type="checkbox"] {
    width: 18px;
    height: 18px;
    accent-color: #27ae60;
  }

  .pack-item.checked label {
    text-decoration: line-through;
    color: #aaa;
  }

  /* Phrases */
  .phrase-item {
    padding: 10px 0;
    border-bottom: 1px solid #eee;
  }

  .phrase-item:last-child { border-bottom: none; }

  .phrase-spanish {
    font-weight: 600;
    color: #333;
    font-size: 0.95rem;
  }

  .phrase-dutch {
    font-size: 0.8rem;
    color: #888;
    margin-top: 2px;
  }

  .phrase-pronunciation {
    font-size: 0.75rem;
    color: #e74c3c;
    font-style: italic;
    margin-top: 2px;
  }

  /* Photo Spots */
  .photo-spot {
    display: flex;
    gap: 12px;
    padding: 10px 0;
    border-bottom: 1px solid #eee;
    cursor: pointer;
    transition: background 0.2s;
  }

  .photo-spot:hover {
    background: #f8f9fa;
    margin: 0 -10px;
    padding: 10px;
    border-radius: 8px;
  }

  .photo-spot:last-child { border-bottom: none; }

  .photo-spot-icon { font-size: 1.5rem; }

  .photo-spot-info { flex: 1; }

  .photo-spot-name {
    font-weight: 600;
    font-size: 0.9rem;
    color: #333;
  }

  .photo-spot-tip {
    font-size: 0.75rem;
    color: #888;
  }

  .photo-spot-time {
    font-size: 0.7rem;
    color: #f7931e;
    font-weight: 500;
  }

  /* Transport */
  .transport-item {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 10px 0;
    border-bottom: 1px solid #eee;
  }

  .transport-item:last-child { border-bottom: none; }

  .transport-icon { font-size: 1.3rem; }

  .transport-info { flex: 1; }

  .transport-title {
    font-weight: 600;
    font-size: 0.9rem;
    color: #333;
  }

  .transport-detail {
    font-size: 0.8rem;
    color: #666;
    margin-top: 2px;
  }

  /* Emergency */
  .emergency-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px;
    background: #fff5f5;
    border-radius: 8px;
    margin-bottom: 8px;
  }

  .emergency-item:last-child { margin-bottom: 0; }

  .emergency-icon { font-size: 1.3rem; }

  .emergency-info { flex: 1; }

  .emergency-title {
    font-weight: 600;
    font-size: 0.85rem;
    color: #333;
  }

  .emergency-number {
    font-size: 1rem;
    color: #e74c3c;
    font-weight: 600;
  }

  .emergency-number a {
    color: #e74c3c;
    text-decoration: none;
  }

  /* Spotify */
  .spotify-embed {
    border-radius: 12px;
    overflow: hidden;
  }

  /* QR Code */
  .qr-section {
    text-align: center;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 12px;
    margin-top: 15px;
  }

  .qr-code {
    width: 120px;
    height: 120px;
    margin: 10px auto;
    background: white;
    padding: 8px;
    border-radius: 8px;
  }

  .qr-text {
    font-size: 0.75rem;
    color: #888;
  }

  /* Hidden Gems Section */
  .gems-section {
    margin-top: 25px;
    margin-bottom: 10px;
  }

  .gems-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    flex-wrap: wrap;
    gap: 15px;
  }

  .gems-header h2 {
    font-family: 'Playfair Display', serif;
    color: white;
    font-size: 1.6rem;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
  }

  .gems-controls {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }

  .gem-filter {
    padding: 8px 16px;
    border: 2px solid white;
    background: transparent;
    color: white;
    border-radius: 20px;
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 500;
    transition: all 0.2s;
  }

  .gem-filter:hover, .gem-filter.active {
    background: white;
    color: #f7931e;
  }

  .surprise-btn {
    padding: 8px 20px;
    background: white;
    color: #e74c3c;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 600;
    transition: all 0.2s;
    animation: pulse 2s infinite;
  }

  .surprise-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  }

  @keyframes pulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(255,255,255,0.4); }
    50% { box-shadow: 0 0 0 8px rgba(255,255,255,0); }
  }

  .gems-scroll-container {
    overflow-x: auto;
    padding-bottom: 15px;
    margin: 0 -10px;
    padding: 0 10px 15px;
    scrollbar-width: thin;
    scrollbar-color: rgba(255,255,255,0.5) transparent;
  }

  .gems-scroll-container::-webkit-scrollbar {
    height: 6px;
  }

  .gems-scroll-container::-webkit-scrollbar-track {
    background: rgba(255,255,255,0.2);
    border-radius: 3px;
  }

  .gems-scroll-container::-webkit-scrollbar-thumb {
    background: rgba(255,255,255,0.5);
    border-radius: 3px;
  }

  .gems-list {
    display: flex;
    gap: 15px;
    padding: 5px 0;
  }

  .gem-card {
    flex: 0 0 280px;
    background: white;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    cursor: pointer;
    transition: all 0.3s;
    position: relative;
  }

  .gem-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 35px rgba(0,0,0,0.2);
  }

  .gem-card.highlighted {
    animation: highlight 0.6s ease;
    box-shadow: 0 0 0 4px #e74c3c, 0 12px 35px rgba(0,0,0,0.25);
  }

  @keyframes highlight {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.03); }
  }

  .gem-category-badge {
    position: absolute;
    top: 12px;
    left: 12px;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .gem-category-badge.eten { background: #e74c3c; color: white; }
  .gem-category-badge.drinken { background: #9b59b6; color: white; }
  .gem-category-badge.cultuur { background: #3498db; color: white; }
  .gem-category-badge.natuur { background: #27ae60; color: white; }
  .gem-category-badge.winkelen { background: #f39c12; color: white; }

  .gem-image {
    height: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  }

  .gem-content {
    padding: 15px;
  }

  .gem-name {
    font-weight: 600;
    font-size: 1rem;
    color: #333;
    margin-bottom: 4px;
  }

  .gem-neighborhood {
    font-size: 0.75rem;
    color: #888;
    margin-bottom: 8px;
  }

  .gem-description {
    font-size: 0.82rem;
    color: #555;
    line-height: 1.4;
    margin-bottom: 10px;
  }

  .gem-local-tip {
    font-size: 0.75rem;
    color: #e74c3c;
    font-style: italic;
    padding-top: 8px;
    border-top: 1px solid #eee;
  }

  .gem-actions {
    display: flex;
    gap: 8px;
    margin-top: 12px;
  }

  .gem-btn {
    flex: 1;
    padding: 8px 12px;
    border: none;
    border-radius: 8px;
    font-size: 0.75rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    text-decoration: none;
    text-align: center;
  }

  .gem-btn-maps {
    background: #4285f4;
    color: white;
  }

  .gem-btn-maps:hover {
    background: #3367d6;
  }

  .gem-btn-save {
    background: #f8f9fa;
    color: #333;
    border: 1px solid #ddd;
  }

  .gem-btn-save:hover {
    background: #e9ecef;
  }

  .gem-btn-save.saved {
    background: #27ae60;
    color: white;
    border-color: #27ae60;
  }

  /* Route Map Section */
  .route-section {
    margin-top: 25px;
    margin-bottom: 20px;
  }

  .route-card {
    background: white;
    border-radius: 16px;
    padding: 20px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.12);
  }

  #route-map {
    height: 400px;
    border-radius: 12px;
    z-index: 1;
    margin-bottom: 16px;
  }

  .route-legend {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    margin-bottom: 16px;
    padding: 12px;
    background: #f8f9fa;
    border-radius: 10px;
  }

  .route-legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.85rem;
    color: #444;
  }

  .route-line {
    width: 24px;
    height: 4px;
    border-radius: 2px;
  }

  .route-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }

  .route-btn {
    padding: 10px 18px;
    border: 2px solid #ddd;
    background: white;
    border-radius: 25px;
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 500;
    color: #555;
    transition: all 0.2s;
  }

  .route-btn:hover {
    border-color: var(--btn-color, #ff6b35);
    color: var(--btn-color, #ff6b35);
  }

  .route-btn.active {
    background: var(--btn-color, #ff6b35);
    border-color: var(--btn-color, #ff6b35);
    color: white;
  }

  /* ============ RESPONSIVE MEDIA QUERIES ============ */

  /* Tablet and below */
  @media (max-width: 900px) {
    .main-grid {
      grid-template-columns: 1fr;
    }

    .sidebar {
      order: -1;
    }

    #map {
      height: 250px;
    }

    .info-grid {
      grid-template-columns: 1fr;
    }

    .gems-list {
      flex-wrap: nowrap;
    }

    .gem-card {
      flex: 0 0 260px;
    }
  }

  /* Mobile */
  @media (max-width: 600px) {
    body {
      padding: 12px;
      padding-bottom: calc(70px + var(--safe-bottom));
    }

    #route-map {
      height: 300px;
    }

    .route-legend {
      flex-direction: column;
      gap: 8px;
    }

    .route-legend-item {
      font-size: 0.8rem;
    }

    .route-buttons {
      overflow-x: auto;
      flex-wrap: nowrap;
      padding-bottom: 8px;
      -webkit-overflow-scrolling: touch;
    }

    .route-btn {
      white-space: nowrap;
      padding: 8px 14px;
      font-size: 0.8rem;
    }

    .header h1 {
      font-size: 1.8rem;
    }

    .header .subtitle {
      font-size: 0.85rem;
    }

    .card {
      padding: 16px;
      border-radius: 14px;
    }

    .weather-card {
      flex-direction: column;
      text-align: center;
      padding: 16px;
      gap: 12px;
    }

    .weather-details {
      width: 100%;
      justify-content: space-around;
    }

    .day-card {
      border-radius: 12px;
    }

    .day-header {
      padding: 14px;
      min-height: 56px;
    }

    .activity-list {
      padding: 0 14px 14px;
    }

    .activity-list li {
      padding: 8px 0;
      font-size: 0.85rem;
    }

    .info-card {
      padding: 16px;
      border-radius: 14px;
    }

    .info-card h3 {
      font-size: 1rem;
    }

    .gem-card {
      flex: 0 0 240px;
    }

    .gems-header {
      flex-direction: column;
      align-items: flex-start;
    }

    .gems-header h2 {
      font-size: 1.3rem;
    }

    .gems-controls {
      width: 100%;
      overflow-x: auto;
      padding-bottom: 8px;
      -webkit-overflow-scrolling: touch;
    }

    .gem-filter {
      padding: 6px 12px;
      font-size: 0.75rem;
      white-space: nowrap;
    }

    .surprise-btn {
      padding: 6px 14px;
      font-size: 0.75rem;
    }

    /* Show bottom nav on mobile */
    .bottom-nav {
      display: flex;
    }

    .footer {
      padding-bottom: 60px;
    }

    /* Make touch targets larger */
    .tip, .transport-item, .phrase-item, .photo-spot {
      padding: 12px 0;
    }

    .emergency-item {
      padding: 12px;
    }

    .pack-item {
      padding: 10px 0;
      min-height: 44px;
      display: flex;
      align-items: center;
    }

    .pack-item input[type="checkbox"] {
      width: 22px;
      height: 22px;
    }
  }

  /* Small mobile */
  @media (max-width: 380px) {
    body {
      padding: 10px;
    }

    .header h1 {
      font-size: 1.5rem;
    }

    .weather-temp {
      font-size: 2.2rem;
    }

    .weather-icon {
      font-size: 2.2rem;
    }

    .day-emoji {
      font-size: 1.2rem;
    }

    .day-title {
      font-size: 0.9rem;
    }

    .gem-card {
      flex: 0 0 220px;
    }
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    * {
      transition: none !important;
      animation: none !important;
    }

    html {
      scroll-behavior: auto;
    }
  }

  /* Print styles */
  @media print {
    body {
      background: white;
      padding: 0;
    }

    .bottom-nav,
    .gems-section,
    .spotify-embed,
    .qr-section {
      display: none;
    }

    .card {
      box-shadow: none;
      border: 1px solid #ddd;
    }
  }
</style>
</head>
<body>
<div class="container">
  <header class="header">
    <h1>Valencia Weekendje</h1>
    <p class="subtitle">7-10 februari 2026 | Romantisch uitje</p>
  </header>

  <div class="card weather-card" id="weather-container">
    <div class="weather-main">
      <div class="weather-city">Valencia, Spanje</div>
      <div class="weather-temp" id="weather-temp">--¬∞C</div>
      <div class="weather-desc" id="weather-desc">Weer laden...</div>
    </div>
    <div class="weather-icon" id="weather-icon">üå§Ô∏è</div>
    <div class="weather-details">
      <div class="weather-detail">
        <div class="weather-detail-value" id="weather-humidity">--%</div>
        <div class="weather-detail-label">Luchtvochtigheid</div>
      </div>
      <div class="weather-detail">
        <div class="weather-detail-value" id="weather-wind">-- km/u</div>
        <div class="weather-detail-label">Wind</div>
      </div>
      <div class="weather-detail">
        <div class="weather-detail-value" id="weather-feels">--¬∞C</div>
        <div class="weather-detail-label">Gevoelstemperatuur</div>
      </div>
    </div>
  </div>

  <div class="main-grid">
    <div class="itinerary-section" id="itinerary">
      <h2 class="section-title">üìÖ Ons 4-daags programma</h2>

      <div class="day-card friday" onclick="toggleDay(this)">
        <div class="day-header">
          <span class="day-emoji">üç∑</span>
          <div><div class="day-title">Vrijdagavond</div><div class="day-subtitle">Aankomst & eerste indrukken</div></div>
          <span class="day-arrow">‚ñº</span>
        </div>
        <div class="day-content">
          <ul class="activity-list">
            <li><span class="activity-time">Avond</span> Inchecken bij ESTIMAR Valencia (oude centrum)</li>
            <li><span class="activity-time">19:00</span> Wandeling door Plaza de la Virgen & Plaza de la Reina</li>
            <li><span class="activity-time">21:00</span> Tapas eten bij La Pepica of El Carmen</li>
            <li><span class="activity-time">23:00</span> Drankjes in Barrio del Carmen</li>
          </ul>
        </div>
      </div>

      <div class="day-card saturday" onclick="toggleDay(this)">
        <div class="day-header">
          <span class="day-emoji">üèõÔ∏è</span>
          <div><div class="day-title">Zaterdag</div><div class="day-subtitle">Cultuur & bezienswaardigheden</div></div>
          <span class="day-arrow">‚ñº</span>
        </div>
        <div class="day-content">
          <ul class="activity-list">
            <li><span class="activity-time">09:00</span> Mercado Central ‚Äî vers sap & jam√≥n</li>
            <li><span class="activity-time">11:00</span> La Lonja de la Seda (UNESCO erfgoed)</li>
            <li><span class="activity-time">12:00</span> Kathedraal van Valencia + Miguelete Toren</li>
            <li><span class="activity-time">14:00</span> Lunch in oude centrum (tapas bij El Poblet of La Riu√†)</li>
            <li><span class="activity-time">16:30</span> Stad van Kunsten en Wetenschappen</li>
            <li><span class="activity-time">21:00</span> Diner & uitgaan in Ruzafa</li>
          </ul>
        </div>
      </div>

      <div class="day-card sunday" onclick="toggleDay(this)">
        <div class="day-header">
          <span class="day-emoji">üèñÔ∏è</span>
          <div><div class="day-title">Zondag</div><div class="day-subtitle">Strand, parken & paella</div></div>
          <span class="day-arrow">‚ñº</span>
        </div>
        <div class="day-content">
          <ul class="activity-list">
            <li><span class="activity-time">10:00</span> Fietsen door Turia Park richting strand</li>
            <li><span class="activity-time">12:00</span> Verkennen van wijk Cabanyal (street art)</li>
            <li><span class="activity-time">14:00</span> Authentieke paella bij Casa Carmela ü•ò</li>
            <li><span class="activity-time">16:30</span> Relaxen op Malvarrosa strand</li>
            <li><span class="activity-time">19:00</span> Rooftop drankjes bij Ateneo Sky Bar</li>
            <li><span class="activity-time">22:00</span> Uitgaan in El Carmen</li>
          </ul>
        </div>
      </div>

      <div class="day-card monday" onclick="toggleDay(this)">
        <div class="day-header">
          <span class="day-emoji">‚òÄÔ∏è</span>
          <div><div class="day-title">Maandagochtend</div><div class="day-subtitle">Laatste hapjes & vertrek</div></div>
          <span class="day-arrow">‚ñº</span>
        </div>
        <div class="day-content">
          <ul class="activity-list">
            <li><span class="activity-time">10:00</span> Brunch bij Bluebell Coffee</li>
            <li><span class="activity-time">11:30</span> Laatste wandeling, souvenirs (horchata, turr√≥n)</li>
            <li><span class="activity-time">13:00</span> Naar het vliegveld</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="sidebar">
      <div class="card map-card">
        <h3>üìç Belangrijke locaties</h3>
        <div id="map"></div>
        <div class="legend">
          <div class="legend-item"><span class="legend-dot hotel"></span> Hotel</div>
          <div class="legend-item"><span class="legend-dot food"></span> Eten</div>
          <div class="legend-item"><span class="legend-dot culture"></span> Cultuur</div>
          <div class="legend-item"><span class="legend-dot nightlife"></span> Uitgaan</div>
          <div class="legend-item"><span class="legend-dot nature"></span> Natuur</div>
        </div>
      </div>

      <div class="card tips-card">
        <h3>üí° Handige tips</h3>
        <div class="tip"><span class="tip-icon">üö∂</span><span class="tip-text">Oude centrum is goed te belopen ‚Äî huur fietsen voor Turia/strand</span></div>
        <div class="tip"><span class="tip-icon">ü•ò</span><span class="tip-text">Paella is een lunch gerecht ‚Äî paella bij diner = toeristenval!</span></div>
        <div class="tip"><span class="tip-icon">üïê</span><span class="tip-text">Spanjaarden eten laat: lunch 14:00, diner 21:00+</span></div>
        <div class="tip"><span class="tip-icon">üçä</span><span class="tip-text">Probeer horchata & fartons ‚Äî lokale specialiteit!</span></div>
      </div>

      <div class="card clothing-card">
        <h3>üëî Wat aan te trekken</h3>
        <p style="font-size:0.7rem;color:#888;margin-bottom:10px;">üîÑ Live voorspelling ‚Äî update automatisch</p>
        <div id="clothing-recommendations">
          <div class="clothing-day">
            <span class="clothing-icon">‚è≥</span>
            <div class="clothing-day-info">
              <div class="clothing-day-name">Voorspelling laden...</div>
              <div class="clothing-day-weather">Weerdata ophalen</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Hidden Gems Section -->
  <div class="gems-section" id="gems-section">
    <div class="gems-header">
      <h2>üíé Hidden Gems ‚Äî Waar locals heen gaan</h2>
      <div class="gems-controls">
        <button class="gem-filter active" data-filter="all">Alles</button>
        <button class="gem-filter" data-filter="eten">üç¥ Eten</button>
        <button class="gem-filter" data-filter="drinken">üç∑ Drinken</button>
        <button class="gem-filter" data-filter="cultuur">üé® Cultuur</button>
        <button class="gem-filter" data-filter="natuur">üåø Natuur</button>
        <button class="surprise-btn" onclick="surpriseMe()">üé≤ Verras ons!</button>
      </div>
    </div>
    <div class="gems-scroll-container">
      <div class="gems-list" id="gems-list">
        <!-- Gems worden via JavaScript geladen -->
      </div>
    </div>
  </div>

  <!-- Extra Info Grid -->
  <div class="info-grid" id="info-section">

    <!-- Budget -->
    <div class="info-card">
      <h3>üí∞ Budget Overzicht</h3>
      <div class="budget-item">
        <span class="budget-label">üè® Hotel (3 nachten ESTIMAR)</span>
        <span class="budget-amount">~‚Ç¨450</span>
      </div>
      <div class="budget-item">
        <span class="budget-label">‚úàÔ∏è Vluchten (retour p.p.)</span>
        <span class="budget-amount">~‚Ç¨150</span>
      </div>
      <div class="budget-item">
        <span class="budget-label">üçΩÔ∏è Eten & drinken (4 dagen)</span>
        <span class="budget-amount">~‚Ç¨300</span>
      </div>
      <div class="budget-item">
        <span class="budget-label">üé´ Activiteiten & entree</span>
        <span class="budget-amount">~‚Ç¨60</span>
      </div>
      <div class="budget-item">
        <span class="budget-label">üöï Transport (metro/taxi)</span>
        <span class="budget-amount">~‚Ç¨40</span>
      </div>
      <div class="budget-item budget-total">
        <span class="budget-label">Totaal geschat (voor 2)</span>
        <span class="budget-amount" style="color:#27ae60;">~‚Ç¨1.000</span>
      </div>
      <p style="font-size:0.7rem;color:#888;margin-top:10px;">üí° Tip: Lunch is goedkoper dan diner. Paella ~‚Ç¨15 p.p. bij lunch!</p>
    </div>

    <!-- Packing List -->
    <div class="info-card">
      <h3>üìã Paklijst</h3>
      <div class="pack-category">
        <div class="pack-category-title">Kleding</div>
        <div class="pack-item"><input type="checkbox" id="p1"><label for="p1">Lichte jas / vest</label></div>
        <div class="pack-item"><input type="checkbox" id="p2"><label for="p2">Comfortabele wandelschoenen</label></div>
        <div class="pack-item"><input type="checkbox" id="p3"><label for="p3">Uitgaanskleding</label></div>
        <div class="pack-item"><input type="checkbox" id="p4"><label for="p4">Zwemkleding</label></div>
        <div class="pack-item"><input type="checkbox" id="p5"><label for="p5">Zonnebril</label></div>
      </div>
      <div class="pack-category">
        <div class="pack-category-title">Essentials</div>
        <div class="pack-item"><input type="checkbox" id="p6"><label for="p6">Paspoort / ID</label></div>
        <div class="pack-item"><input type="checkbox" id="p7"><label for="p7">Telefoon + oplader</label></div>
        <div class="pack-item"><input type="checkbox" id="p8"><label for="p8">Bankpas + creditcard</label></div>
        <div class="pack-item"><input type="checkbox" id="p9"><label for="p9">Paraplu (compact)</label></div>
        <div class="pack-item"><input type="checkbox" id="p10"><label for="p10">Zonnebrand</label></div>
      </div>
    </div>

    <!-- Transport -->
    <div class="info-card">
      <h3>üöá Transport</h3>
      <div class="transport-item">
        <span class="transport-icon">‚úàÔ∏è</span>
        <div class="transport-info">
          <div class="transport-title">Vliegveld ‚Üí Centrum</div>
          <div class="transport-detail">Metro lijn 3 of 5 ‚Üí Col√≥n (‚Ç¨5, ~25 min)</div>
          <div class="transport-detail">Taxi ~‚Ç¨20-25 (15 min)</div>
        </div>
      </div>
      <div class="transport-item">
        <span class="transport-icon">üöá</span>
        <div class="transport-info">
          <div class="transport-title">Metro Valencia</div>
          <div class="transport-detail">Enkele rit ‚Ç¨1.50 | Dagkaart ‚Ç¨4.50</div>
          <div class="transport-detail">Dichtsbij hotel: Metro Col√≥n (L3, L9)</div>
        </div>
      </div>
      <div class="transport-item">
        <span class="transport-icon">üö≤</span>
        <div class="transport-info">
          <div class="transport-title">Fietsen huren</div>
          <div class="transport-detail">Valenbisi (deelfietsen) ‚Ç¨13/week</div>
          <div class="transport-detail">Perfect voor Turia Park & strand!</div>
        </div>
      </div>
      <div class="transport-item">
        <span class="transport-icon">üöï</span>
        <div class="transport-info">
          <div class="transport-title">Taxi</div>
          <div class="transport-detail">Free Now / Cabify app werkt hier</div>
          <div class="transport-detail">Centrum ‚Üí Strand ~‚Ç¨8-10</div>
        </div>
      </div>
    </div>

    <!-- Emergency -->
    <div class="info-card">
      <h3>üÜò Noodgevallen</h3>
      <div class="emergency-item">
        <span class="emergency-icon">üö®</span>
        <div class="emergency-info">
          <div class="emergency-title">Algemeen noodnummer</div>
          <div class="emergency-number"><a href="tel:112">112</a></div>
        </div>
      </div>
      <div class="emergency-item">
        <span class="emergency-icon">üè•</span>
        <div class="emergency-info">
          <div class="emergency-title">Ziekenhuis (Hospital La Fe)</div>
          <div class="emergency-number"><a href="tel:+34961244000">+34 961 244 000</a></div>
        </div>
      </div>
      <div class="emergency-item">
        <span class="emergency-icon">üá≥üá±</span>
        <div class="emergency-info">
          <div class="emergency-title">Nederlandse Ambassade Madrid</div>
          <div class="emergency-number"><a href="tel:+34913536200">+34 91 353 6200</a></div>
        </div>
      </div>
      <div class="emergency-item">
        <span class="emergency-icon">üëÆ</span>
        <div class="emergency-info">
          <div class="emergency-title">Politie (niet-spoed)</div>
          <div class="emergency-number"><a href="tel:091">091</a></div>
        </div>
      </div>
    </div>

    <!-- Spanish Phrases -->
    <div class="info-card">
      <h3>üá™üá∏ Handige Spaanse Zinnen</h3>
      <div class="phrase-item">
        <div class="phrase-spanish">Hola, una mesa para dos, por favor</div>
        <div class="phrase-dutch">Hallo, een tafel voor twee, alstublieft</div>
        <div class="phrase-pronunciation">O-la, oe-na m√©-sa pa-ra dos, por fa-vor</div>
      </div>
      <div class="phrase-item">
        <div class="phrase-spanish">La cuenta, por favor</div>
        <div class="phrase-dutch">De rekening, alstublieft</div>
        <div class="phrase-pronunciation">La kwen-ta, por fa-vor</div>
      </div>
      <div class="phrase-item">
        <div class="phrase-spanish">¬øQu√© nos recomienda?</div>
        <div class="phrase-dutch">Wat raadt u aan?</div>
        <div class="phrase-pronunciation">K√© nos re-ko-mjen-da?</div>
      </div>
      <div class="phrase-item">
        <div class="phrase-spanish">Dos cervezas, por favor</div>
        <div class="phrase-dutch">Twee biertjes, alstublieft</div>
        <div class="phrase-pronunciation">Dos ser-v√©-sas, por fa-vor</div>
      </div>
      <div class="phrase-item">
        <div class="phrase-spanish">¬øD√≥nde est√°...?</div>
        <div class="phrase-dutch">Waar is...?</div>
        <div class="phrase-pronunciation">D√≥n-de es-t√°...?</div>
      </div>
      <div class="phrase-item">
        <div class="phrase-spanish">¬°Qu√© rico! / ¬°Muy bueno!</div>
        <div class="phrase-dutch">Wat lekker! / Erg goed!</div>
        <div class="phrase-pronunciation">K√© r√≠-ko! / Moei bw√©-no!</div>
      </div>
    </div>

    <!-- Photo Spots -->
    <div class="info-card">
      <h3>üì∏ Beste Foto Spots</h3>
      <div class="photo-spot" onclick="showPhotoSpot([39.4542, -0.3507], 'City of Arts & Sciences')">
        <span class="photo-spot-icon">üèõÔ∏è</span>
        <div class="photo-spot-info">
          <div class="photo-spot-name">City of Arts & Sciences</div>
          <div class="photo-spot-tip">Reflectie in het water, futuristische architectuur</div>
          <div class="photo-spot-time">üåÖ Beste: zonsondergang of blauw uurtje</div>
        </div>
      </div>
      <div class="photo-spot" onclick="showPhotoSpot([39.4752, -0.3754], 'Plaza de la Virgen')">
        <span class="photo-spot-icon">‚õ™</span>
        <div class="photo-spot-info">
          <div class="photo-spot-name">Plaza de la Virgen</div>
          <div class="photo-spot-tip">Fontein + kathedraal, authentiek Valencia</div>
          <div class="photo-spot-time">‚òÄÔ∏è Beste: ochtendlicht of avond</div>
        </div>
      </div>
      <div class="photo-spot" onclick="showPhotoSpot([39.4695, -0.3258], 'Cabanyal straten')">
        <span class="photo-spot-icon">üé®</span>
        <div class="photo-spot-info">
          <div class="photo-spot-name">Cabanyal Street Art</div>
          <div class="photo-spot-tip">Kleurrijke tegels en muurschilderingen</div>
          <div class="photo-spot-time">üì∑ Beste: bewolkt (geen harde schaduwen)</div>
        </div>
      </div>
      <div class="photo-spot" onclick="showPhotoSpot([39.4728, -0.3251], 'Malvarrosa strand')">
        <span class="photo-spot-icon">üèñÔ∏è</span>
        <div class="photo-spot-info">
          <div class="photo-spot-name">Malvarrosa Beach</div>
          <div class="photo-spot-tip">Palmbomen, promenade, zee</div>
          <div class="photo-spot-time">üåÖ Beste: zonsopgang (rustig!)</div>
        </div>
      </div>
      <div class="photo-spot" onclick="showPhotoSpot([39.4743, -0.3787], 'Mercado Central')">
        <span class="photo-spot-icon">üçä</span>
        <div class="photo-spot-info">
          <div class="photo-spot-name">Mercado Central</div>
          <div class="photo-spot-tip">Art nouveau hal, kleurrijk fruit</div>
          <div class="photo-spot-time">üïê Beste: 's ochtends (drukte!)</div>
        </div>
      </div>
    </div>

    <!-- Spotify Playlist -->
    <div class="info-card">
      <h3>üéµ Valencia Playlist</h3>
      <p style="font-size:0.8rem;color:#666;margin-bottom:12px;">Spaanse sfeer voor onderweg! ‚òÄÔ∏è</p>
      <div class="spotify-embed">
        <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/37i9dQZF1DX5HBBUIpXGY0?utm_source=generator&theme=0" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
      </div>
      <div class="qr-section">
        <div class="qr-text">üì± Deel deze pagina met je vriendin:</div>
        <img class="qr-code" src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=https://friso-kolkman.github.io/valencia-trip-2026/" alt="QR Code">
        <div class="qr-text" style="margin-top:5px;font-weight:500;">Scan om te openen</div>
        <div class="qr-text">Geen wachtwoord nodig! üéâ</div>
      </div>
    </div>

    <!-- Reservations & Links -->
    <div class="info-card">
      <h3>üîó Reserveren & Boeken</h3>
      <div class="transport-item">
        <span class="transport-icon">ü•ò</span>
        <div class="transport-info">
          <div class="transport-title">Casa Carmela (Paella)</div>
          <div class="transport-detail">Reserveren aanbevolen voor weekend!</div>
          <a href="tel:+34963710073" style="font-size:0.85rem;color:#4285f4;">üìû +34 963 71 00 73</a>
        </div>
      </div>
      <div class="transport-item">
        <span class="transport-icon">üéüÔ∏è</span>
        <div class="transport-info">
          <div class="transport-title">Oceanogr√†fic (optioneel)</div>
          <div class="transport-detail">Online tickets = geen wachtrij</div>
          <a href="https://www.oceanografic.org/en/" target="_blank" style="font-size:0.85rem;color:#4285f4;">üåê Tickets kopen</a>
        </div>
      </div>
      <div class="transport-item">
        <span class="transport-icon">üö≤</span>
        <div class="transport-info">
          <div class="transport-title">Valenbisi Fietsen</div>
          <div class="transport-detail">Registreer online voor ‚Ç¨13/week</div>
          <a href="https://www.valenbisi.es/" target="_blank" style="font-size:0.85rem;color:#4285f4;">üåê Aanmelden</a>
        </div>
      </div>
      <div class="transport-item">
        <span class="transport-icon">üöï</span>
        <div class="transport-info">
          <div class="transport-title">Taxi Apps</div>
          <div class="transport-detail">Download alvast:</div>
          <div style="font-size:0.85rem;color:#4285f4;">Free Now ‚Ä¢ Cabify</div>
        </div>
      </div>
    </div>

  </div>

  <!-- Route Map Section -->
  <div class="route-section">
    <h2 class="section-title" style="color:white;text-shadow:1px 1px 3px rgba(0,0,0,0.2);margin-bottom:16px;">üó∫Ô∏è Onze Route per Dag</h2>
    <div class="route-card">
      <div id="route-map"></div>
      <div class="route-legend">
        <div class="route-legend-item">
          <span class="route-line" style="background:#e74c3c;"></span>
          <span>Vrijdag ‚Äî Aankomst & avondwandeling</span>
        </div>
        <div class="route-legend-item">
          <span class="route-line" style="background:#3498db;"></span>
          <span>Zaterdag ‚Äî Cultuur & bezienswaardigheden</span>
        </div>
        <div class="route-legend-item">
          <span class="route-line" style="background:#27ae60;"></span>
          <span>Zondag ‚Äî Strand & parken</span>
        </div>
        <div class="route-legend-item">
          <span class="route-line" style="background:#9b59b6;"></span>
          <span>Maandag ‚Äî Brunch & vertrek</span>
        </div>
      </div>
      <div class="route-buttons">
        <button class="route-btn active" data-day="all">Alle dagen</button>
        <button class="route-btn" data-day="friday" style="--btn-color:#e74c3c;">Vrijdag</button>
        <button class="route-btn" data-day="saturday" style="--btn-color:#3498db;">Zaterdag</button>
        <button class="route-btn" data-day="sunday" style="--btn-color:#27ae60;">Zondag</button>
        <button class="route-btn" data-day="monday" style="--btn-color:#9b59b6;">Maandag</button>
      </div>
    </div>
  </div>

  <div class="footer">Gemaakt met ‚ù§Ô∏è voor jullie Valencia avontuur</div>
</div>

<!-- Bottom Navigation (Mobile) -->
<nav class="bottom-nav">
  <a href="#weather-container" class="nav-item">
    <span class="nav-item-icon">üå§Ô∏è</span>
    <span class="nav-item-label">Weer</span>
  </a>
  <a href="#itinerary" class="nav-item">
    <span class="nav-item-icon">üìÖ</span>
    <span class="nav-item-label">Planning</span>
  </a>
  <a href="#map" class="nav-item">
    <span class="nav-item-icon">üìç</span>
    <span class="nav-item-label">Kaart</span>
  </a>
  <a href="#gems-section" class="nav-item">
    <span class="nav-item-icon">üíé</span>
    <span class="nav-item-label">Gems</span>
  </a>
  <a href="#info-section" class="nav-item">
    <span class="nav-item-icon">‚ÑπÔ∏è</span>
    <span class="nav-item-label">Info</span>
  </a>
</nav>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
// Initialize map
const map = L.map('map').setView([39.4699, -0.3763], 13);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '¬© OpenStreetMap'
}).addTo(map);

// Custom marker icons
const createIcon = (color) => L.divIcon({
  className: 'custom-marker',
  html: `<div style="background:${color};width:24px;height:24px;border-radius:50%;border:3px solid white;box-shadow:0 2px 5px rgba(0,0,0,0.3);"></div>`,
  iconSize: [24, 24],
  iconAnchor: [12, 12]
});

const hotelIcon = createIcon('#f39c12');
const foodIcon = createIcon('#e74c3c');
const cultureIcon = createIcon('#3498db');
const nightlifeIcon = createIcon('#9b59b6');
const natureIcon = createIcon('#27ae60');

// Add markers
const locations = [
  { coords: [39.4705, -0.3742], name: 'ESTIMAR Valencia (Hotel)', icon: hotelIcon },
  { coords: [39.4762, -0.3756], name: 'Plaza de la Virgen', icon: cultureIcon },
  { coords: [39.4735, -0.3785], name: 'Mercado Central', icon: cultureIcon },
  { coords: [39.4738, -0.3796], name: 'La Lonja de la Seda', icon: cultureIcon },
  { coords: [39.4752, -0.3754], name: 'Valencia Cathedral', icon: cultureIcon },
  { coords: [39.4531, -0.3511], name: 'City of Arts & Sciences', icon: cultureIcon },
  { coords: [39.4822, -0.3258], name: 'Casa Carmela (Paella)', icon: foodIcon },
  { coords: [39.4627, -0.3735], name: 'Ruzafa (Dining)', icon: foodIcon },
  { coords: [39.4790, -0.3790], name: 'Barrio del Carmen', icon: nightlifeIcon },
  { coords: [39.4699, -0.3763], name: 'Ateneo Sky Bar', icon: nightlifeIcon },
  { coords: [39.4780, -0.3650], name: 'Turia Gardens', icon: natureIcon },
  { coords: [39.4793, -0.3236], name: 'Malvarrosa Beach', icon: natureIcon },
  { coords: [39.4695, -0.3270], name: 'Cabanyal', icon: natureIcon }
];

locations.forEach(loc => {
  L.marker(loc.coords, { icon: loc.icon })
    .addTo(map)
    .bindPopup(`<strong>${loc.name}</strong>`);
});

// Weather code mapping (Dutch)
const weatherMap = {
  0: { desc: 'Onbewolkt', icon: '‚òÄÔ∏è' },
  1: { desc: 'Overwegend helder', icon: 'üå§Ô∏è' },
  2: { desc: 'Licht bewolkt', icon: '‚õÖ' },
  3: { desc: 'Bewolkt', icon: '‚òÅÔ∏è' },
  45: { desc: 'Mistig', icon: 'üå´Ô∏è' },
  48: { desc: 'Mistig', icon: 'üå´Ô∏è' },
  51: { desc: 'Lichte motregen', icon: 'üå¶Ô∏è' },
  53: { desc: 'Motregen', icon: 'üå¶Ô∏è' },
  55: { desc: 'Zware motregen', icon: 'üåßÔ∏è' },
  61: { desc: 'Lichte regen', icon: 'üåßÔ∏è' },
  63: { desc: 'Regen', icon: 'üåßÔ∏è' },
  65: { desc: 'Zware regen', icon: 'üåßÔ∏è' },
  80: { desc: 'Regenbuien', icon: 'üå¶Ô∏è' },
  95: { desc: 'Onweer', icon: '‚õàÔ∏è' }
};

// Get clothing recommendation based on weather (Dutch)
function getClothingRec(temp, weatherCode, dayType, rainChance) {
  let items = [];
  const isRainy = [51, 53, 55, 61, 63, 65, 80, 95].includes(weatherCode);
  const highRainChance = rainChance > 40;

  // Base layer
  if (temp >= 18) {
    items.push('T-shirt');
  } else if (temp >= 14) {
    items.push('Longsleeve');
  } else {
    items.push('Trui');
  }

  // Outer layer - fixed logic order
  if (temp < 10) {
    items.push('warme jas');
  } else if (temp < 16) {
    items.push('lichte jas');
  }

  // Rain gear
  if (isRainy || highRainChance) {
    items.push('paraplu');
    if (isRainy) {
      items.push('regenjas');
    }
  }

  // Day-specific - check weather first!
  if (dayType === 'beach') {
    if (!isRainy && !highRainChance) {
      items.push('zwemkleding');
      items.push('zonnebril');
    } else {
      items.push('comfortabele schoenen');
      items.push('reserveplan: museum of indoor activiteit');
    }
  } else if (dayType === 'nightlife') {
    items.push('smart casual outfit');
  } else if (dayType === 'walking') {
    items.push('comfortabele schoenen');
  }

  // Sunglasses only when not rainy
  if (temp >= 12 && !isRainy && !highRainChance && dayType !== 'beach') {
    items.push('zonnebril');
  }

  return items.join(', ');
}

// Fetch current weather
fetch('https://api.open-meteo.com/v1/forecast?latitude=39.47&longitude=-0.38&current=temperature_2m,relative_humidity_2m,apparent_temperature,weather_code,wind_speed_10m&timezone=Europe/Madrid')
  .then(res => res.json())
  .then(data => {
    const current = data.current;
    const temp = Math.round(current.temperature_2m);
    const feels = Math.round(current.apparent_temperature);
    const humidity = current.relative_humidity_2m;
    const wind = Math.round(current.wind_speed_10m);
    const weatherCode = current.weather_code;
    const weather = weatherMap[weatherCode] || { desc: 'Variable', icon: 'üå§Ô∏è' };

    document.getElementById('weather-temp').textContent = temp + '¬∞C';
    document.getElementById('weather-desc').textContent = weather.desc;
    document.getElementById('weather-icon').textContent = weather.icon;
    document.getElementById('weather-humidity').textContent = humidity + '%';
    document.getElementById('weather-wind').textContent = wind + ' km/u';
    document.getElementById('weather-feels').textContent = feels + '¬∞C';
  })
  .catch(() => {
    document.getElementById('weather-desc').textContent = 'Weer niet beschikbaar';
  });

// Fetch 4-day forecast for clothing recommendations
fetch('https://api.open-meteo.com/v1/forecast?latitude=39.47&longitude=-0.38&daily=temperature_2m_max,temperature_2m_min,weather_code,precipitation_probability_max&timezone=Europe/Madrid&forecast_days=7')
  .then(res => res.json())
  .then(data => {
    const daily = data.daily;
    const tripDays = [
      { name: 'Vrijdag', subtitle: 'Avondwandeling & tapas', type: 'nightlife', idx: 0 },
      { name: 'Zaterdag', subtitle: 'Cultuur & bezienswaardigheden', type: 'walking', idx: 1 },
      { name: 'Zondag', subtitle: 'Strand & parken', type: 'beach', idx: 2 },
      { name: 'Maandag', subtitle: 'Brunch & vertrek', type: 'walking', idx: 3 }
    ];

    let html = '';
    tripDays.forEach(day => {
      const idx = day.idx;
      const maxTemp = Math.round(daily.temperature_2m_max[idx]);
      const minTemp = Math.round(daily.temperature_2m_min[idx]);
      const avgTemp = Math.round((maxTemp + minTemp) / 2);
      const weatherCode = daily.weather_code[idx];
      const rainChance = daily.precipitation_probability_max[idx];
      const weather = weatherMap[weatherCode] || { desc: 'Variable', icon: 'üå§Ô∏è' };
      const clothing = getClothingRec(avgTemp, weatherCode, day.type, rainChance);

      html += `
        <div class="clothing-day">
          <span class="clothing-icon">${weather.icon}</span>
          <div class="clothing-day-info">
            <div class="clothing-day-name">${day.name} <span style="font-weight:400;color:#888;">‚Äî ${day.subtitle}</span></div>
            <div class="clothing-day-weather">${minTemp}¬∞‚Äì${maxTemp}¬∞C ¬∑ ${weather.desc}${rainChance > 30 ? ' ¬∑ ' + rainChance + '% kans op regen' : ''}</div>
            <div class="clothing-day-items">${clothing}</div>
          </div>
        </div>
      `;
    });

    document.getElementById('clothing-recommendations').innerHTML = html;
  })
  .catch(() => {
    document.getElementById('clothing-recommendations').innerHTML = `
      <div class="clothing-day">
        <span class="clothing-icon">üß•</span>
        <div class="clothing-day-info">
          <div class="clothing-day-name">Algemene inpaktips</div>
          <div class="clothing-day-weather">Februari in Valencia: 10‚Äì17¬∞C normaal</div>
          <div class="clothing-day-items">Laagjes, lichte jas, comfortabele wandelschoenen, paraplu voor de zekerheid</div>
        </div>
      </div>
    `;
  });

// ============ HIDDEN GEMS ============
const hiddenGems = [
  {
    name: "Bar Ricardo",
    category: "eten",
    neighborhood: "El Carmen",
    emoji: "üç≥",
    coords: [39.4781, -0.3798],
    description: "Piepklein barretje met de beste tortilla van Valencia. Geen menu, gewoon wijzen naar wat je wilt.",
    localTip: "Ga voor 13:00, anders is de tortilla op!",
    maps: "https://maps.google.com/?q=Bar+Ricardo+Valencia"
  },
  {
    name: "Horchater√≠a Santa Catalina",
    category: "eten",
    neighborhood: "Ciutat Vella",
    emoji: "ü•õ",
    coords: [39.4738, -0.3771],
    description: "Sinds 1836! De oudste horchater√≠a van Valencia. Authentieke horchata met fartons.",
    localTip: "Bestel 'horchata granizada' voor de echte ervaring.",
    maps: "https://maps.google.com/?q=Horchateria+Santa+Catalina+Valencia"
  },
  {
    name: "Bodega Casa Monta√±a",
    category: "drinken",
    neighborhood: "Cabanyal",
    emoji: "üç∑",
    coords: [39.4731, -0.3685],
    description: "Wijnbar uit 1836 met vaten aan de muur. Perfecte vermouth en conservas.",
    localTip: "Vraag om 'cl√≥chinas' (lokale mosselen) als ze er zijn.",
    maps: "https://maps.google.com/?q=Casa+Montana+Valencia"
  },
  {
    name: "El Kiosko",
    category: "drinken",
    neighborhood: "Turia Park",
    emoji: "üç∫",
    coords: [39.4782, -0.3651],
    description: "Relaxte buitenbar in het park. Locals komen hier na het hardlopen of fietsen.",
    localTip: "Neem een Agua de Valencia ‚Äî champagne met sinaasappel!",
    maps: "https://maps.google.com/?q=El+Kiosko+Turia+Valencia"
  },
  {
    name: "Mercado de Tapiner√≠a",
    category: "eten",
    neighborhood: "Ciutat Vella",
    emoji: "ü•ò",
    coords: [39.4755, -0.3768],
    description: "Kleine foodhall met lokale producten. Minder toeristisch dan Mercado Central.",
    localTip: "Probeer de 'esgarraet' bij de hoekbar.",
    maps: "https://maps.google.com/?q=Mercado+de+Tapineria+Valencia"
  },
  {
    name: "Jard√≠n Bot√°nico",
    category: "natuur",
    neighborhood: "Ciutat Vella",
    emoji: "üå¥",
    coords: [39.4745, -0.3853],
    description: "Verborgen botanische tuin met 200 jaar oude bomen. Oase van rust.",
    localTip: "Perfecte plek voor een middagdutje op het gras.",
    maps: "https://maps.google.com/?q=Jardin+Botanico+Valencia"
  },
  {
    name: "Caf√© de las Horas",
    category: "drinken",
    neighborhood: "El Carmen",
    emoji: "üç∏",
    coords: [39.4773, -0.3785],
    description: "Barokke cocktailbar met fluwelen stoelen en kroonluchters. Voelt als een tijdmachine.",
    localTip: "Bestel de huiscocktail 'Agua de Valencia'.",
    maps: "https://maps.google.com/?q=Cafe+de+las+Horas+Valencia"
  },
  {
    name: "Russafa Markt",
    category: "eten",
    neighborhood: "Ruzafa",
    emoji: "üçÖ",
    coords: [39.4618, -0.3731],
    description: "Lokale markt waar echte Valencianen hun groenten kopen. Geen toeristen!",
    localTip: "Zaterdagochtend is het gezelligst.",
    maps: "https://maps.google.com/?q=Mercado+de+Ruzafa+Valencia"
  },
  {
    name: "IVAM",
    category: "cultuur",
    neighborhood: "El Carmen",
    emoji: "üñºÔ∏è",
    coords: [39.4792, -0.3832],
    description: "Modern kunstmuseum met gratis toegang. Vaak bijzondere tentoonstellingen.",
    localTip: "Check hun website voor gratis rondleidingen.",
    maps: "https://maps.google.com/?q=IVAM+Valencia"
  },
  {
    name: "Playa del Saler",
    category: "natuur",
    neighborhood: "Albufera",
    emoji: "üèñÔ∏è",
    coords: [39.3842, -0.3217],
    description: "Rustig strand in natuurpark. Waar Valencianen heen gaan om drukte te ontlopen.",
    localTip: "Combineer met zonsondergang bij Albufera!",
    maps: "https://maps.google.com/?q=Playa+del+Saler+Valencia"
  },
  {
    name: "Ubik Caf√©",
    category: "drinken",
    neighborhood: "Ruzafa",
    emoji: "üìö",
    coords: [39.4612, -0.3728],
    description: "Boekenwinkel + caf√©. Hippe plek om te werken of mensen te kijken.",
    localTip: "Probeer hun carrot cake, beste van de stad.",
    maps: "https://maps.google.com/?q=Ubik+Cafe+Valencia"
  },
  {
    name: "La F√°brica de Hielo",
    category: "drinken",
    neighborhood: "Cabanyal",
    emoji: "üé§",
    coords: [39.4698, -0.3272],
    description: "Oude ijsfabriek nu cultureel centrum. Live muziek, expo's, en chill terras.",
    localTip: "Check hun agenda voor concerten!",
    maps: "https://maps.google.com/?q=La+Fabrica+de+Hielo+Valencia"
  },
  {
    name: "Dulce de Leche",
    category: "eten",
    neighborhood: "Ruzafa",
    emoji: "ü•ê",
    coords: [39.4615, -0.3742],
    description: "Argentijnse bakkerij met ongelooflijke croissants en medialunas.",
    localTip: "Neem alfajores mee als souvenir!",
    maps: "https://maps.google.com/?q=Dulce+de+Leche+Ruzafa+Valencia"
  },
  {
    name: "Street Art Route Cabanyal",
    category: "cultuur",
    neighborhood: "Cabanyal",
    emoji: "üé®",
    coords: [39.4695, -0.3258],
    description: "Kleurrijke straatkunst door de hele vissersbuurt. Elke straat is anders.",
    localTip: "Loop via Calle de la Reina richting strand.",
    maps: "https://maps.google.com/?q=Cabanyal+Valencia"
  },
  {
    name: "Nou Rac√≥",
    category: "eten",
    neighborhood: "Albufera",
    emoji: "ü•ò",
    coords: [39.3523, -0.3542],
    description: "Paella restaurant midden in de rijstvelden. Hier leren chefs paella maken.",
    localTip: "Reserveer en vraag om tafel met uitzicht op het water.",
    maps: "https://maps.google.com/?q=Nou+Raco+Palmar+Valencia"
  }
];

// Render gems
function renderGems(filter = 'all') {
  const container = document.getElementById('gems-list');
  const filtered = filter === 'all' ? hiddenGems : hiddenGems.filter(g => g.category === filter);

  container.innerHTML = filtered.map((gem, idx) => `
    <div class="gem-card" data-idx="${idx}" data-category="${gem.category}">
      <span class="gem-category-badge ${gem.category}">${gem.category}</span>
      <div class="gem-image">${gem.emoji}</div>
      <div class="gem-content">
        <div class="gem-name">${gem.name}</div>
        <div class="gem-neighborhood">üìç ${gem.neighborhood}</div>
        <div class="gem-description">${gem.description}</div>
        <div class="gem-local-tip">üí¨ "${gem.localTip}"</div>
        <div class="gem-actions">
          <a href="${gem.maps}" target="_blank" class="gem-btn gem-btn-maps" onclick="event.stopPropagation();">üìç Google Maps</a>
          <button class="gem-btn gem-btn-save" onclick="toggleSave(event, '${gem.name}')">‚ô° Bewaar</button>
        </div>
      </div>
    </div>
  `).join('');

  // Add click handlers to show on map
  document.querySelectorAll('.gem-card').forEach(card => {
    card.addEventListener('click', () => {
      const idx = parseInt(card.dataset.idx);
      const gem = filter === 'all' ? hiddenGems[idx] : filtered[idx];
      showOnMap(gem);
    });
  });
}

// Filter buttons
document.querySelectorAll('.gem-filter').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.gem-filter').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    renderGems(btn.dataset.filter);
  });
});

// Show gem on main map
function showOnMap(gem) {
  map.setView(gem.coords, 16);
  L.popup()
    .setLatLng(gem.coords)
    .setContent(`<strong>${gem.emoji} ${gem.name}</strong><br><small>${gem.localTip}</small>`)
    .openOn(map);

  // Scroll map into view
  document.getElementById('map').scrollIntoView({ behavior: 'smooth', block: 'center' });
}

// Surprise me button
function surpriseMe() {
  const randomGem = hiddenGems[Math.floor(Math.random() * hiddenGems.length)];

  // Reset filter to all
  document.querySelectorAll('.gem-filter').forEach(b => b.classList.remove('active'));
  document.querySelector('.gem-filter[data-filter="all"]').classList.add('active');
  renderGems('all');

  // Find and highlight the card
  setTimeout(() => {
    const cards = document.querySelectorAll('.gem-card');
    const targetCard = Array.from(cards).find(c => {
      const idx = parseInt(c.dataset.idx);
      return hiddenGems[idx].name === randomGem.name;
    });

    if (targetCard) {
      targetCard.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });
      targetCard.classList.add('highlighted');
      setTimeout(() => targetCard.classList.remove('highlighted'), 2000);

      // Show on map
      showOnMap(randomGem);
    }
  }, 100);
}

// Save/unsave functionality
function toggleSave(event, gemName) {
  event.stopPropagation();
  const btn = event.target;
  btn.classList.toggle('saved');
  btn.textContent = btn.classList.contains('saved') ? '‚ô• Bewaard!' : '‚ô° Bewaar';
}

// Initial render
renderGems();

// ============ PACKING LIST ============
document.querySelectorAll('.pack-item input[type="checkbox"]').forEach(checkbox => {
  // Load saved state
  const saved = localStorage.getItem('pack_' + checkbox.id);
  if (saved === 'true') {
    checkbox.checked = true;
    checkbox.parentElement.classList.add('checked');
  }

  // Save on change
  checkbox.addEventListener('change', (e) => {
    localStorage.setItem('pack_' + checkbox.id, checkbox.checked);
    if (checkbox.checked) {
      checkbox.parentElement.classList.add('checked');
    } else {
      checkbox.parentElement.classList.remove('checked');
    }
  });
});

// ============ PHOTO SPOTS ============
function showPhotoSpot(coords, name) {
  map.setView(coords, 17);
  L.popup()
    .setLatLng(coords)
    .setContent(`<strong>üì∏ ${name}</strong><br><small>Foto spot!</small>`)
    .openOn(map);
  document.getElementById('map').scrollIntoView({ behavior: 'smooth', block: 'center' });
}

// ============ DAY CARD TOGGLE ============
function toggleDay(card) {
  // Close other cards on mobile for cleaner UX
  if (window.innerWidth <= 600) {
    document.querySelectorAll('.day-card.open').forEach(c => {
      if (c !== card) c.classList.remove('open');
    });
  }
  card.classList.toggle('open');
}

// Open first day card by default on desktop
if (window.innerWidth > 600) {
  document.querySelector('.day-card.friday')?.classList.add('open');
}

// ============ BOTTOM NAV ACTIVE STATE ============
const navItems = document.querySelectorAll('.nav-item');
const sections = ['weather-container', 'itinerary', 'map', 'gems-section', 'info-section'];

function updateActiveNav() {
  const scrollPos = window.scrollY + 100;

  sections.forEach((sectionId, idx) => {
    const section = document.getElementById(sectionId);
    if (section) {
      const top = section.offsetTop;
      const bottom = top + section.offsetHeight;

      if (scrollPos >= top && scrollPos < bottom) {
        navItems.forEach(n => n.classList.remove('active'));
        navItems[idx]?.classList.add('active');
      }
    }
  });
}

window.addEventListener('scroll', updateActiveNav, { passive: true });
updateActiveNav();

// Smooth scroll for nav items
navItems.forEach(item => {
  item.addEventListener('click', (e) => {
    e.preventDefault();
    const targetId = item.getAttribute('href').slice(1);
    const target = document.getElementById(targetId);
    if (target) {
      const offset = 20;
      window.scrollTo({
        top: target.offsetTop - offset,
        behavior: 'smooth'
      });
    }
  });
});

// ============ TOUCH IMPROVEMENTS ============
// Prevent double-tap zoom on interactive elements
document.querySelectorAll('.day-header, .gem-filter, .surprise-btn, .gem-btn, .nav-item').forEach(el => {
  el.addEventListener('touchend', (e) => {
    e.preventDefault();
    el.click();
  }, { passive: false });
});

// ============ ROUTE MAP ============
const routeMap = L.map('route-map').setView([39.4650, -0.3550], 13);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '¬© OpenStreetMap'
}).addTo(routeMap);

// Hotel marker (start point for all routes)
const hotelCoords = [39.4705, -0.3742];
L.marker(hotelCoords, { icon: hotelIcon })
  .addTo(routeMap)
  .bindPopup('<strong>üè® ESTIMAR Valencia</strong><br>Jullie hotel');

// Route definitions per day
const routes = {
  friday: {
    color: '#e74c3c',
    name: 'Vrijdag',
    points: [
      hotelCoords,
      [39.4762, -0.3756], // Plaza de la Virgen
      [39.4752, -0.3754], // Cathedral area
      [39.4775, -0.3785], // El Carmen area (tapas)
      [39.4790, -0.3790], // Barrio del Carmen (nightlife)
    ],
    stops: [
      { coords: [39.4762, -0.3756], name: 'Plaza de la Virgen', time: '19:00' },
      { coords: [39.4775, -0.3785], name: 'Tapas in El Carmen', time: '21:00' },
      { coords: [39.4790, -0.3790], name: 'Barrio del Carmen', time: '23:00' },
    ]
  },
  saturday: {
    color: '#3498db',
    name: 'Zaterdag',
    points: [
      hotelCoords,
      [39.4735, -0.3785], // Mercado Central
      [39.4738, -0.3796], // La Lonja
      [39.4752, -0.3754], // Cathedral
      [39.4745, -0.3770], // Lunch old town
      [39.4531, -0.3511], // City of Arts & Sciences
      [39.4627, -0.3735], // Ruzafa
    ],
    stops: [
      { coords: [39.4735, -0.3785], name: 'Mercado Central', time: '09:00' },
      { coords: [39.4738, -0.3796], name: 'La Lonja de la Seda', time: '11:00' },
      { coords: [39.4752, -0.3754], name: 'Kathedraal', time: '12:00' },
      { coords: [39.4745, -0.3770], name: 'Lunch oude centrum', time: '14:00' },
      { coords: [39.4531, -0.3511], name: 'Stad van Kunsten', time: '16:30' },
      { coords: [39.4627, -0.3735], name: 'Ruzafa', time: '21:00' },
    ]
  },
  sunday: {
    color: '#27ae60',
    name: 'Zondag',
    points: [
      hotelCoords,
      [39.4780, -0.3650], // Turia Park
      [39.4695, -0.3270], // Cabanyal
      [39.4822, -0.3258], // Casa Carmela
      [39.4793, -0.3236], // Malvarrosa Beach
      [39.4699, -0.3763], // Ateneo Sky Bar
      [39.4790, -0.3790], // El Carmen
    ],
    stops: [
      { coords: [39.4780, -0.3650], name: 'Turia Park', time: '10:00' },
      { coords: [39.4695, -0.3270], name: 'Cabanyal (street art)', time: '12:00' },
      { coords: [39.4822, -0.3258], name: 'Casa Carmela (Paella!)', time: '14:00' },
      { coords: [39.4793, -0.3236], name: 'Malvarrosa Strand', time: '16:30' },
      { coords: [39.4699, -0.3763], name: 'Ateneo Sky Bar', time: '19:00' },
      { coords: [39.4790, -0.3790], name: 'El Carmen', time: '22:00' },
    ]
  },
  monday: {
    color: '#9b59b6',
    name: 'Maandag',
    points: [
      hotelCoords,
      [39.4720, -0.3760], // Bluebell Coffee area
      [39.4735, -0.3785], // Walking/souvenirs near Mercado
      [39.4620, -0.4820], // Airport
    ],
    stops: [
      { coords: [39.4720, -0.3760], name: 'Bluebell Coffee', time: '10:00' },
      { coords: [39.4735, -0.3785], name: 'Souvenirs', time: '11:30' },
    ]
  }
};

// Store polylines and markers for toggling
const routeLayers = {};

// Create polylines and stop markers for each day
Object.keys(routes).forEach(day => {
  const route = routes[day];
  routeLayers[day] = {
    line: L.polyline(route.points, {
      color: route.color,
      weight: 4,
      opacity: 0.8,
      smoothFactor: 1
    }),
    markers: route.stops.map((stop, idx) => {
      const marker = L.circleMarker(stop.coords, {
        radius: 8,
        fillColor: route.color,
        color: '#fff',
        weight: 2,
        fillOpacity: 0.9
      }).bindPopup(`<strong>${stop.time}</strong><br>${stop.name}`);
      return marker;
    })
  };
});

// Show all routes by default
function showRoute(day) {
  if (day === 'all') {
    Object.keys(routeLayers).forEach(d => {
      routeLayers[d].line.addTo(routeMap);
      routeLayers[d].markers.forEach(m => m.addTo(routeMap));
    });
    routeMap.fitBounds([
      [39.44, -0.48],
      [39.50, -0.32]
    ]);
  } else {
    // Hide all first
    Object.keys(routeLayers).forEach(d => {
      routeMap.removeLayer(routeLayers[d].line);
      routeLayers[d].markers.forEach(m => routeMap.removeLayer(m));
    });
    // Show selected
    routeLayers[day].line.addTo(routeMap);
    routeLayers[day].markers.forEach(m => m.addTo(routeMap));
    routeMap.fitBounds(routeLayers[day].line.getBounds().pad(0.2));
  }
}

// Initialize with all routes
showRoute('all');

// Button click handlers
document.querySelectorAll('.route-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.route-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    showRoute(btn.dataset.day);
  });
});
</script>
</body>
</html>
